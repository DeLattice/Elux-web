<form [formGroup]="form"
      tuiForm="m"
>
  <tui-textfield
    iconStart="@tui.code"
    tuiTextfieldSize="m"
  >
    <input
      tuiTextfield
      placeholder="Enter URL/base64/text-config with configs"
      formControlName="name"
    />
    <tui-icon [tuiTooltip]="textFieldPayloadTooltip"/>
  </tui-textfield>

  <tui-textfield
    iconStart="@tui.code"
    tuiTextfieldSize="m"
  >
    <input
      tuiTextfield
      placeholder="Enter url to sub"
      formControlName="subUrl"
    />
    <tui-icon [tuiTooltip]="textFieldPayloadTooltip"/>
  </tui-textfield>

  <tui-notification appearance="warning">
    <h3 tuiTitle>
      Entering configs
      <span tuiSubtitle>You can safely leave the last field for config input empty, as it is added automatically and you can use it if necessary.</span>
    </h3>
  </tui-notification>

  <ng-container formArrayName="payload">
    @for (control of payload.controls; track $index) {
      <tui-textfield
        iconStart="@tui.code"
        tuiTextfieldSize="m"
      >
        <input
          [formControl]="control"
          [placeholder]="'Enter URL/base64/text-config with configs'"
          tuiTextfield
          (blur)="onFieldBlur($index)"
        />
        <tui-icon [tuiTooltip]="textFieldPayloadTooltip"/>
      </tui-textfield>
    }
  </ng-container>

  <footer>
    <button
      appearance="secondary"
      tuiButton
      type="button"
    >
      Cancel
    </button>
    <button
      tuiButton
      type="submit"
    >
      Submit
    </button>
  </footer>
</form>

<ng-template #textFieldPayloadTooltip>
  <div>Valid data:</div>
  <br>
  <div>protocol://user_id@ip:port?...etc.</div>
  <hr class="tui-space_top-1 tui-space_bottom-1" />
  <div>I3Byb2ZpbGUtdGl0bGU6IGJhc...</div>
  <hr class="tui-space_top-1 tui-space_bottom-1" />
  <div>https://example.com/a.txt</div>
</ng-template>
